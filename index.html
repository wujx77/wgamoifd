<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>We Marry - å©šç¤¼è¯·æŸ¬åˆ¶ä½œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Parisienne&display=swap" rel="stylesheet">
    <style>
        /* --- 1. å…¨å±€æ ·å¼è®¾ç½® (æ¸…æ–°è‡ªç„¶é£) --- */
        :root {
            --primary-green: #749F82; /* é¼ å°¾è‰ç»¿ */
            --light-green: #E8F3E8;
            --text-main: #425e4f;
            --cream: #FFFAF0;
            --white: #ffffff;
            --shadow: 0 10px 30px rgba(116, 159, 130, 0.15);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Noto Serif SC', serif;
            background-color: var(--light-green);
            color: var(--text-main);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- 2. åˆ¶ä½œå™¨ç•Œé¢ (Editor) --- */
        .editor-container {
            max-width: 800px;
            margin: 40px auto;
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            transition: all 0.5s ease;
        }

        h1 {
            text-align: center;
            font-family: 'Parisienne', cursive;
            font-size: 3rem;
            color: var(--primary-green);
            margin-bottom: 30px;
        }

        .step-group {
            margin-bottom: 25px;
            border-bottom: 1px dashed #ddd;
            padding-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--text-main);
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: inherit;
            margin-bottom: 10px;
            background: #fafafa;
        }

        input:focus {
            outline: none;
            border-color: var(--primary-green);
            background: var(--white);
        }

        /* æ¨¡ç‰ˆé€‰æ‹© */
        .template-options {
            display: flex;
            gap: 15px;
        }
        .tpl-card {
            flex: 1;
            padding: 15px;
            border: 2px solid #eee;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            transition: 0.3s;
        }
        .tpl-card:hover, .tpl-card.active {
            border-color: var(--primary-green);
            background: var(--light-green);
        }

        /* æŒ‰é’® */
        .btn-generate {
            width: 100%;
            padding: 15px;
            background-color: var(--primary-green);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 20px;
        }
        .btn-generate:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(116, 159, 130, 0.4);
        }

        /* --- 3. æœ€ç»ˆè¯·æŸ¬ç•Œé¢ (Preview/Result) --- */
        #final-invite {
            display: none; /* åˆå§‹éšè— */
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--cream);
            z-index: 100;
            overflow-y: auto;
            text-align: center;
        }

        .invite-content {
            max-width: 480px; /* æ¨¡æ‹Ÿæ‰‹æœºå®½åº¦ */
            margin: 0 auto;
            background: var(--white);
            min-height: 100vh;
            padding: 40px 20px;
            position: relative;
            box-shadow: 0 0 50px rgba(0,0,0,0.05);
        }

        /* è£…é¥°å…ƒç´  */
        .decoration {
            width: 100%;
            height: 20px;
            background: url('data:image/svg+xml;utf8,<svg width="40" height="10" viewBox="0 0 40 10" xmlns="http://www.w3.org/2000/svg"><path d="M0 10 Q 10 0 20 10 T 40 10" stroke="%23749F82" fill="none" stroke-width="2"/></svg>') repeat-x;
            margin: 20px 0;
            opacity: 0.5;
        }

        .invite-photo {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 100px 100px 0 0; /* æ‹±é—¨å½¢çŠ¶ */
            margin-bottom: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .invite-names {
            font-family: 'Parisienne', cursive;
            font-size: 3rem;
            color: var(--primary-green);
            margin: 10px 0;
        }

        .invite-details {
            margin: 30px 0;
            font-size: 1.1rem;
            line-height: 2;
        }

        .map-btn {
            display: inline-block;
            padding: 10px 30px;
            border: 1px solid var(--primary-green);
            color: var(--primary-green);
            border-radius: 30px;
            text-decoration: none;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        /* éŸ³ä¹æ§åˆ¶ */
        .music-control {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            animation: spin 4s linear infinite;
            z-index: 200;
        }
        
        .music-paused {
            animation-play-state: paused;
            opacity: 0.6;
        }

        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* åº•éƒ¨æ“ä½œæ  */
        .action-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            padding: 15px;
            display: flex;
            justify-content: center;
            gap: 20px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
        }

        .action-btn {
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-edit { background: #eee; color: #333; }
        .btn-share { background: var(--primary-green); color: white; }

        /* æ¨¡ç‰ˆæ ·å¼å·®å¼‚ */
        .theme-classic .invite-photo { border-radius: 5px; border: 10px solid #fff; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
        .theme-modern .invite-photo { border-radius: 200px; width: 300px; height: 300px; margin: 0 auto 30px; }
        
    </style>
</head>
<body>

    <div class="editor-container" id="editor">
        <h1>Design Your Wedding</h1>
        
        <div class="step-group">
            <label>1. é€‰æ‹©æ¨¡ç‰ˆé£æ ¼</label>
            <div class="template-options">
                <div class="tpl-card active" onclick="selectTemplate('default', this)">ğŸŒ¿ æ¸…æ–°æ‹±é—¨</div>
                <div class="tpl-card" onclick="selectTemplate('classic', this)">ğŸ“· ç»å…¸ç•™ç™½</div>
                <div class="tpl-card" onclick="selectTemplate('modern', this)">âšª ç°ä»£åœ†å½¢</div>
            </div>
        </div>

        <div class="step-group">
            <label>2. ä¸Šä¼ å©šçº±ç…§ (ç”¨äºå°é¢)</label>
            <input type="file" id="photoInput" accept="image/*">
        </div>

        <div class="step-group">
            <label>3. å©šç¤¼ä¿¡æ¯</label>
            <input type="text" id="groomName" placeholder="æ–°éƒå§“å" value="æé›·">
            <input type="text" id="brideName" placeholder="æ–°å¨˜å§“å" value="éŸ©æ¢…æ¢…">
            
            <label>æ—¶é—´ä¸æ—¥æœŸ</label>
            <input type="date" id="weddingDate">
            <input type="time" id="weddingTime" value="11:08">

            <label>å©šç¤¼åœ°ç‚¹ (å°†è‡ªåŠ¨ç”Ÿæˆåœ°å›¾é“¾æ¥)</label>
            <input type="text" id="locationName" placeholder="ä¾‹å¦‚ï¼šé¦™æ ¼é‡Œæ‹‰å¤§é…’åº—å®´ä¼šå…">
        </div>

        <div class="step-group">
            <label>4. èƒŒæ™¯éŸ³ä¹</label>
            <select id="bgMusic">
                <option value="canon">Canon in D (é’¢ç´ç‰ˆ)</option>
                <option value="wedding_march">å©šç¤¼è¿›è¡Œæ›² (ç»å…¸)</option>
                <option value="beautiful">Beautiful in White</option>
            </select>
        </div>

        <button class="btn-generate" onclick="generateInvite()">âœ¨ ä¸€é”®ç”Ÿæˆè¯·æŸ¬</button>
    </div>

    <div id="final-invite">
        <audio id="audioPlayer" loop></audio>
        
        <div class="music-control" onclick="toggleMusic()">ğŸµ</div>

        <div class="invite-content" id="inviteCard">
            <div class="decoration"></div>
            
            <div class="invite-header">
                <p>æˆ‘ä»¬è¦ç»“å©šå•¦</p>
                <p style="color: #999; font-size: 0.9rem; margin-top:5px;">SAVE THE DATE</p>
            </div>
            
            <div style="margin: 30px 0;">
                <img id="displayPhoto" src="https://images.unsplash.com/photo-1519741497674-611481863552?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" class="invite-photo" alt="Wedding Photo">
            </div>

            <div class="invite-names">
                <span id="showGroom">Groom</span> & <span id="showBride">Bride</span>
            </div>

            <div class="decoration"></div>

            <div class="invite-details">
                <p>è°¨å®šäº</p>
                <p style="font-weight: bold; font-size: 1.3rem; margin: 10px 0;" id="showDate">2024.05.20</p>
                <p id="showTime">11:08</p>
                <br>
                <p>è¯šæŒšé‚€è¯·æ‚¨è§è¯æˆ‘ä»¬çš„å¹¸ç¦æ—¶åˆ»</p>
                <p style="margin-top: 20px; color: var(--text-main); font-weight: bold;" id="showLocation">åœ°ç‚¹åŠ è½½ä¸­...</p>
                
                <a href="#" target="_blank" id="mapLink" class="map-btn">ğŸ“ å¯¼èˆªå»è¿™é‡Œ</a>
            </div>
            
            <div style="margin-top: 50px; font-size: 0.8rem; color: #aaa;">
                <p>æœŸå¾…æ‚¨çš„å…‰ä¸´</p>
            </div>
        </div>

        <div class="action-bar">
            <button class="action-btn btn-edit" onclick="backToEdit()">âœï¸ è¿”å›ä¿®æ”¹</button>
            <button class="action-btn btn-share" onclick="shareInvite()">ğŸ“¤ åˆ†äº«ç»™å¥½å‹</button>
        </div>
    </div>

    <script>
        let selectedTemplate = 'default';
        let uploadedImageURL = null;

        // 1. é€‰æ‹©æ¨¡ç‰ˆé€»è¾‘
        function selectTemplate(tplName, element) {
            selectedTemplate = tplName;
            // UI æ›´æ–°
            document.querySelectorAll('.tpl-card').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
        }

        // 2. å›¾ç‰‡ä¸Šä¼ é¢„è§ˆ (FileReader)
        document.getElementById('photoInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedImageURL = e.target.result;
                }
                reader.readAsDataURL(file);
            }
        });

        // 3. æ ¸å¿ƒï¼šç”Ÿæˆè¯·æŸ¬
        function generateInvite() {
            // è·å–è¾“å…¥å€¼
            const groom = document.getElementById('groomName').value;
            const bride = document.getElementById('brideName').value;
            const date = document.getElementById('weddingDate').value;
            const time = document.getElementById('weddingTime').value;
            const location = document.getElementById('locationName').value;

            if(!groom || !bride || !location) {
                alert("è¯·å¡«å†™å®Œæ•´çš„æ–°äººå§“åå’Œåœ°ç‚¹å“¦~");
                return;
            }

            // å¡«å……å†…å®¹
            document.getElementById('showGroom').innerText = groom;
            document.getElementById('showBride').innerText = bride;
            document.getElementById('showDate').innerText = date || '2024.10.01';
            document.getElementById('showTime').innerText = time;
            document.getElementById('showLocation').innerText = location;

            // å¤„ç†å›¾ç‰‡
            if (uploadedImageURL) {
                document.getElementById('displayPhoto').src = uploadedImageURL;
            }

            // å¤„ç†åœ°å›¾ (ä½¿ç”¨é€šç”¨åœ°å›¾æœç´¢æ¥å£)
            // è¿™é‡Œä½¿ç”¨äº†é«˜å¾·/ç™¾åº¦/Googleé€šç”¨çš„æœç´¢æŸ¥è¯¢å‚æ•°é€»è¾‘
            const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location)}`;
            const mapLinkBtn = document.getElementById('mapLink');
            mapLinkBtn.href = mapUrl;

            // å¤„ç†æ¨¡ç‰ˆæ ·å¼
            const contentDiv = document.getElementById('inviteCard');
            contentDiv.className = 'invite-content'; // é‡ç½®
            if (selectedTemplate === 'classic') contentDiv.classList.add('theme-classic');
            if (selectedTemplate === 'modern') contentDiv.classList.add('theme-modern');

            // åˆ‡æ¢è§†å›¾
            document.getElementById('editor').style.display = 'none';
            const finalView = document.getElementById('final-invite');
            finalView.style.display = 'block';

            // æ’­æ”¾éŸ³ä¹ (æ³¨æ„ï¼šæµè§ˆå™¨é€šå¸¸é˜»æ­¢è‡ªåŠ¨æ’­æ”¾ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’ï¼Œè¿™é‡Œå°è¯•æ’­æ”¾)
            playMusic();
            
            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo(0, 0);
        }

        // 4. è¿”å›ä¿®æ”¹
        function backToEdit() {
            document.getElementById('final-invite').style.display = 'none';
            document.getElementById('editor').style.display = 'block';
            document.getElementById('audioPlayer').pause();
        }

        // 5. éŸ³ä¹é€»è¾‘
        const audio = document.getElementById('audioPlayer');
        let isPlaying = false;

        function playMusic() {
            // è¿™é‡Œä½¿ç”¨ç¤ºä¾‹éŸ³é¢‘ï¼Œå®é™…ä½¿ç”¨è¯·æ›¿æ¢ä¸ºæ‚¨çš„ mp3 é“¾æ¥
            // ç”±äºç‰ˆæƒåŸå› ï¼Œè¿™é‡Œæš‚æ—¶ä¸æ”¾çœŸå®é•¿é“¾æ¥ï¼Œæ‚¨å¯ä»¥æ›¿æ¢ src
            // æ¨¡æ‹Ÿï¼šaudio.src = "your-music-url.mp3"; 
            console.log("å°è¯•æ’­æ”¾éŸ³ä¹...");
            isPlaying = true;
            document.querySelector('.music-control').classList.remove('music-paused');
            // audio.play().catch(e => console.log("éœ€ç”¨æˆ·äº¤äº’æ‰èƒ½æ’­æ”¾"));
        }

        function toggleMusic() {
            if (isPlaying) {
                audio.pause();
                document.querySelector('.music-control').classList.add('music-paused');
            } else {
                audio.play();
                document.querySelector('.music-control').classList.remove('music-paused');
            }
            isPlaying = !isPlaying;
        }

        // 6. æ¨¡æ‹Ÿåˆ†äº«
        function shareInvite() {
            if (navigator.share) {
                navigator.share({
                    title: 'æˆ‘ä»¬çš„å©šç¤¼è¯·æŸ¬',
                    text: 'è¯šæŒšé‚€è¯·æ‚¨å‚åŠ æˆ‘ä»¬çš„å©šç¤¼',
                    url: window.location.href
                });
            } else {
                alert('é“¾æ¥å·²å¤åˆ¶ï¼æ‚¨å¯ä»¥ç›´æ¥ç²˜è´´å‘é€ç»™å¥½å‹ï¼ˆæ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡µé¢ï¼ŒçœŸå®åˆ†äº«éœ€è¦éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼‰ã€‚');
            }
        }
        
        // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä»Šå¤©ä¹‹å
        document.getElementById('weddingDate').valueAsDate = new Date();
    </script>
</body>
</html>
